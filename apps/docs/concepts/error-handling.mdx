---
title: "Error Handling"
description: "Handle errors gracefully."
---

As you can see, AgentView does a lot to make sure your app state is always correct. It handles items and metadata validation and orchestrates the session lifecycle thanks to a run state.

Any time an error occurs, AgnetView will throw an exception which is an instance of `AgentViewError`. It has `body` and `statusCode` propreties so that it's trivial to just redirect it directly to the user as HTTP responses from your endpoint:

```typescript
import 'dotenv/config'
import { Hono } from 'hono'
import { serve } from '@hono/node-server'
import { AgentView, AgentViewError } from "agentview";
import { OpenAI } from 'openai';

const app = new Hono();
const client = new OpenAI()

const av = new AgentView({
    agent: "my_simple_agent",
    version: "0.2.1"
})

app.post('/chat', async (c) => {
  const { sessionId, input, endUserToken } = await c.req.json();

  // create or get session
  const session = sessionId ?
    await av.sessions.get({ id: sessionId, endUserToken }):
    await av.sessions.create({ agent: "my_simple_agent" })

  // create run
  const run = await av.createRun({ input, sessionId: session.id });

  // generate response
  const response = await client.responses.create({
    model: "gpt-5-nano",
    input: [...session.history, input]
  });

  // push items and close run (the last item of output is assistant message)
  await av.updateRun({
    id: run.id
    items: response.output,
  })

  return c.json({
    output: response.output,
    sessionId: session.id,
    token: session.endUser.token
  })
})

// Handle AgentViewError
app.onError((error, c) => {
  if (error instanceof AgentViewError) {
    return c.json(error.body, error.status);
  }
});

serve({
  fetch: app.fetch,
  port: 3000
}, (info) => {
  console.log(`Agent API server is running on http://localhost:${info.port}`)
})
```

You can now call from your browser:

```ts

```
